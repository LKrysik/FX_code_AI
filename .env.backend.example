# Backend Security Configuration Example
# =========================================
# CRITICAL: This file contains security configuration for the FX Trading AI system.
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.backend.example .env
# 2. Run password migration script: python scripts/migrate_passwords_to_bcrypt.py
# 3. Copy the generated bcrypt hashes into your .env file
# 4. NEVER commit .env to version control (it's in .gitignore)
# 5. Restart the backend after modifying .env

# =============================================================================
# AUTHENTICATION CREDENTIALS (BCRYPT HASHES REQUIRED)
# =============================================================================
# SECURITY REQUIREMENT: All passwords MUST be bcrypt hashes, not plain text.
# Use the migration script to generate hashes:
#   python scripts/migrate_passwords_to_bcrypt.py
#
# Example bcrypt hash format: $2b$12$abcdefg...
# Minimum 60 characters for bcrypt hashes
#
# IMPORTANT: The system will REFUSE to start if these are not properly configured!

# Demo User (Basic permissions - read-only market data)
# Generate hash with: python scripts/migrate_passwords_to_bcrypt.py
DEMO_PASSWORD=$2b$12$EXAMPLE_HASH_REPLACE_WITH_ACTUAL_BCRYPT_HASH_FROM_MIGRATION_SCRIPT

# Trader User (Trading permissions - backtest and paper trading)
# Generate hash with: python scripts/migrate_passwords_to_bcrypt.py
TRADER_PASSWORD=$2b$12$EXAMPLE_HASH_REPLACE_WITH_ACTUAL_BCRYPT_HASH_FROM_MIGRATION_SCRIPT

# Premium User (Full trading permissions including live trading)
# Generate hash with: python scripts/migrate_passwords_to_bcrypt.py
PREMIUM_PASSWORD=$2b$12$EXAMPLE_HASH_REPLACE_WITH_ACTUAL_BCRYPT_HASH_FROM_MIGRATION_SCRIPT

# Admin User (Full system access)
# Generate hash with: python scripts/migrate_passwords_to_bcrypt.py
ADMIN_PASSWORD=$2b$12$EXAMPLE_HASH_REPLACE_WITH_ACTUAL_BCRYPT_HASH_FROM_MIGRATION_SCRIPT

# =============================================================================
# JWT SECRET (REQUIRED - MINIMUM 32 CHARACTERS)
# =============================================================================
# SECURITY REQUIREMENT: Strong JWT secret for token signing
# Generate with: python -c 'import secrets; print(secrets.token_urlsafe(32))'
# Or use the migration script: python scripts/migrate_passwords_to_bcrypt.py
#
# CRITICAL: Never use weak secrets like "secret", "dev_jwt_secret_key", etc.
# The system will REFUSE to start with weak or short secrets!

JWT_SECRET=REPLACE_WITH_STRONG_SECRET_FROM_MIGRATION_SCRIPT_MINIMUM_32_CHARS

# =============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production:
#
# [ ] All passwords are bcrypt hashes (not plain text)
# [ ] JWT_SECRET is at least 32 characters long
# [ ] JWT_SECRET is cryptographically random (use secrets.token_urlsafe)
# [ ] .env file is NOT committed to git
# [ ] .env file has restricted permissions (chmod 600 .env)
# [ ] Passwords are backed up in a secure password manager
# [ ] Default demo accounts are disabled or removed
# [ ] Rate limiting is enabled (default: 5/min for login)
# [ ] CSRF protection is enabled
# [ ] All API endpoints require authentication
# [ ] HTTPS is enabled in production
# [ ] Database connections use SSL/TLS
# [ ] Logs don't contain sensitive information
# [ ] Security monitoring and alerts are configured

# =============================================================================
# TROUBLESHOOTING
# =============================================================================
# If the system fails to start with authentication errors:
#
# 1. "SECURITY ERROR: credentials must be set via environment variables"
#    → Run: python scripts/migrate_passwords_to_bcrypt.py
#    → Copy the generated hashes to .env
#
# 2. "JWT_SECRET must be set to a strong secret"
#    → Generate: python -c 'import secrets; print(secrets.token_urlsafe(32))'
#    → Add to .env: JWT_SECRET=<generated_secret>
#
# 3. "Plain text password detected"
#    → You're using plain text instead of bcrypt hashes
#    → Run migration script to generate proper hashes
#
# 4. Authentication failures after migration
#    → Ensure you're using the NEW passwords (not the old plain text ones)
#    → Check that bcrypt is installed: pip install bcrypt>=4.0.0

# =============================================================================
# BACKWARD COMPATIBILITY (TEMPORARY)
# =============================================================================
# For a limited migration period, the system accepts both:
# - Bcrypt hashes (RECOMMENDED, starts with $2)
# - Plain text passwords (DEPRECATED, for migration only)
#
# A warning will be logged if plain text passwords are detected.
# This backward compatibility will be REMOVED in future versions.
#
# MIGRATE NOW using: python scripts/migrate_passwords_to_bcrypt.py

# =============================================================================
# ADDITIONAL SECURITY NOTES
# =============================================================================
#
# Password Requirements:
# - Bcrypt rounds: 12 (good balance of security and performance)
# - Hash format: $2b$12$...
# - Minimum length: 60 characters for bcrypt hash
#
# JWT Secret Requirements:
# - Minimum length: 32 characters
# - Should be cryptographically random
# - Rotated periodically (recommended: every 90 days)
#
# Rate Limiting (configured in code):
# - Login endpoints: 5 requests/minute
# - Strategy creation: 10 requests/minute
# - Default: 200 requests/minute
#
# CSRF Protection:
# - Enabled by default for all state-changing operations
# - Exempt paths: /auth/login, /auth/refresh, /ws, /health
#
# For more information, see:
# - docs/security/SECURITY.md (security overview)
# - docs/security/DEPLOYMENT.md (deployment guide)
# - scripts/migrate_passwords_to_bcrypt.py (migration script)
